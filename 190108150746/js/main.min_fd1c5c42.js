var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function c(e){try{s(r["throw"](e))}catch(t){i(t)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,c)}s((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(r){n=[6,r],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,c,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return c={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c},Icon=function(e){function t(){var t=e.call(this)||this;return t.skinName="IconSkin",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.clickFunc()},t.prototype.clickFunc=function(){var e=this;this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.currentState="down"},this),this.addEventListener(egret.TouchEvent.TOUCH_END,function(){e.currentState="up"},this)},t.prototype.changeImg=function(e){this.iconImg.texture=RES.getRes(e)},t}(eui.Component);__reflect(Icon.prototype,"Icon"),window.Icon=Icon;var AboutScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="AboutSceneSkin",t}return __extends(t,e),t.prototype.createChildren=function(){this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickFunc,this)},t.prototype.clickFunc=function(){SceneManager.getInstance().gameScene.myIconGroup.aboutIcon.currentState="up";var e=SceneManager.getInstance().gameScene.myIconGroup.iconGroup.getChildAt(SceneManager.getInstance().gameScene.index);e.currentState="down",1==SceneManager.getInstance().gameScene.sceneGroup.numChildren&&(e.currentState="up");var t=egret.Tween.get(SceneManager.getInstance().aboutScene);t.to({x:SceneManager.getInstance().aboutScene.width,y:SceneManager.getInstance().aboutScene.height},300).call(function(){SceneManager.getInstance().removeScene(SceneManager.getInstance().aboutScene),console.log(SceneManager.getInstance().gameScene.sceneGroup)}),platform.shareAppMessage()},t}(eui.Component);__reflect(AboutScene.prototype,"AboutScene");var EquippedItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="EquippedItemSkin",t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this.value=e,this.initFromData(e)},enumerable:!0,configurable:!0}),t.prototype.initFromData=function(e){this.nameLabel.text=e.name,this.equippedImg.texture=RES.getRes(e.img)},t}(eui.ItemRenderer);__reflect(EquippedItem.prototype,"EquippedItem"),window.EquippedIten=EquippedItem;var GameScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.partAdded=function(t,n){e.prototype.partAdded.call(this,t,n)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.myIconGroup.iconGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeState,this)},t.prototype.changeState=function(e){var t=e.target,n=this.myIconGroup.iconGroup.getChildIndex(t);switch(this.index=this.myIconGroup.index,this.myIconGroup.change(n),n){case 0:SceneManager.getInstance().removeAllScene(),SceneManager.getInstance().addScene(SceneManager.getInstance().playerScene);break;case 1:SceneManager.getInstance().removeAllScene(),SceneManager.getInstance().addScene(SceneManager.getInstance().heroScene);break;case 2:SceneManager.getInstance().removeAllScene(),SceneManager.getInstance().addScene(SceneManager.getInstance().goodsScene);break;case 3:SceneManager.getInstance().addScene(SceneManager.getInstance().aboutScene),SceneManager.getInstance().aboutScene.x=0,SceneManager.getInstance().aboutScene.y=0}},t}(eui.Component);__reflect(GameScene.prototype,"GameScene",["eui.UIComponent","egret.DisplayObject"]);var GoodsItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="GoodsItemSkin",t}return __extends(t,e),Object.defineProperty(t.prototype,"data",{set:function(e){this.value=e,this.initFromData(e)},enumerable:!0,configurable:!0}),t.prototype.initFromData=function(e){this.goodsName.text=e.name,this.goodsImg.texture=RES.getRes(e.img),this.goodsIntroduce.text=e.introduce},t}(eui.ItemRenderer);__reflect(GoodsItem.prototype,"GoodsItem"),window.GoodsItem=GoodsItem;var GoodsScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="GoodsSceneSkin",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.dataArr=[{img:"goods01_png",name:"魔法石",introduce:"敏捷加成 +3"},{img:"goods02_png",name:"诅咒娃娃",introduce:"敏捷加成 +3"},{img:"goods03_png",name:"万圣戒指",introduce:"敏捷加成 +3"},{img:"goods04_png",name:"斗篷",introduce:"敏捷加成 +3"},{img:"goods05_png",name:"鹅毛笔",introduce:"敏捷加成 +3"},{img:"goods06_png",name:"血滴子",introduce:"敏捷加成 +3"},{img:"goods07_png",name:"屠龙刀",introduce:"敏捷加成 +3"}];var t=new eui.ArrayCollection(this.dataArr);this.goodsList.dataProvider=t,this.goodsList.itemRenderer=GoodsItem,this.goodsScroller.verticalScrollBar.autoVisibility=!1,this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickFunc,this)},t.prototype.clickFunc=function(){SceneManager.getInstance().removeScene(SceneManager.getInstance().goodsScene),SceneManager.getInstance().gameScene.myIconGroup.goodsIcon.currentState="up"},t}(eui.Component);__reflect(GoodsScene.prototype,"GoodsScene");var HeroItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroItemSkin",t}return __extends(t,e),t.prototype.createChildren=function(){var t=this;e.prototype.createChildren.call(this),this.isSelect.addEventListener(eui.UIEvent.CHANGE,function(e){t.value.isSelect=t.isSelect.selected;var n=SceneManager.getInstance().heroScene.dataArr[t.itemIndex];n.isSelect=t.isSelect.selected,SceneManager.getInstance().heroScene.updata()},this)},Object.defineProperty(t.prototype,"data",{set:function(e){this.value=e,this.initFromData(e)},enumerable:!0,configurable:!0}),t.prototype.initFromData=function(e){this.HeroName.text=e.name,this.HeroHead.texture=RES.getRes(e.img),this.HeroEvaluate.text=e.evaluate,this.isSelect.selected=e.isSelect},t}(eui.ItemRenderer);__reflect(HeroItem.prototype,"HeroItem"),window.HeroItem=HeroItem;var HeroScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="HeroSceneSkin",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.dataArr=[{img:"heros01_png",name:"依文洁琳",evaluate:"评价：殷桃小丸子",isSelect:!1},{img:"heros02_png",name:"亚特伍德",evaluate:"评价：殷桃小丸子",isSelect:!1},{img:"heros03_png",name:"易妮德",evaluate:"评价：殷桃小丸子",isSelect:!1},{img:"heros04_png",name:"鲁斌",evaluate:"评价：殷桃小丸子",isSelect:!1},{img:"heros05_png",name:"威弗雷德",evaluate:"评价：殷桃小丸子",isSelect:!1},{img:"heros06_png",name:"史蒂夫",evaluate:"评价：殷桃小丸子",isSelect:!1},{img:"heros07_png",name:"哈瑞斯",evaluate:"评价：殷桃小丸子",isSelect:!1}],this.updata(),this.heroSceneList.itemRenderer=HeroItem,this.heroSceneScroller.verticalScrollBar.autoVisibility=!1,this.sure.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickFunc,this),this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickFunc2,this)},t.prototype.clickFunc=function(){var e=[];SceneManager.getInstance().removeScene(SceneManager.getInstance().heroScene),SceneManager.getInstance().gameScene.myIconGroup.heroIcon.currentState="up",SceneManager.getInstance().gameScene.selectHero.visible=!0,this.dataArr.forEach(function(t,n){1==t.isSelect&&e.push(t.name)}),0==e.length?SceneManager.getInstance().gameScene.selectHero.text="您未选择任何英雄":SceneManager.getInstance().gameScene.selectHero.text="您选择了英雄："+e,setTimeout(function(){SceneManager.getInstance().gameScene.selectHero.visible=!1},2e3)},t.prototype.createArr=function(){},t.prototype.clickFunc2=function(){SceneManager.getInstance().removeScene(SceneManager.getInstance().heroScene),SceneManager.getInstance().gameScene.myIconGroup.heroIcon.currentState="up"},t.prototype.updata=function(){var e=new eui.ArrayCollection(this.dataArr);this.heroSceneList.dataProvider=e},t}(eui.Component);__reflect(HeroScene.prototype,"HeroScene");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function r(r){t.call(n,r,e)}if(RES.hasRes(e)){var o=RES.getRes(e);o?r(o):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var IconGroup=function(e){function t(){var t=e.call(this)||this;return t.skinName="IconGroupSkin",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.playerIcon.init("mbtnPlayer_png"),this.heroIcon.init("mbtnHero_png"),this.goodsIcon.init("mbtnGoods_png")},t.prototype.change=function(e){for(var t=0;t<this.iconGroup.numChildren;t++){var n=this.iconGroup.getChildAt(t);n.currentState="up"}this.iconGroup.getChildAt(e).currentState="down",3!=e&&(this.index=e)},t}(eui.Component);__reflect(IconGroup.prototype,"IconGroup"),window.IconGroup=IconGroup;var IconItem=function(e){function t(){var t=e.call(this)||this;return t.skinName="IconItemSkin",t.touchEnabled=!0,t.touchChildren=!1,t}return __extends(t,e),t.prototype.init=function(e){this.iconContent.texture=RES.getRes(e)},t.prototype.click=function(){},t}(eui.Component);__reflect(IconItem.prototype,"IconItem"),window.IconItem=IconItem;var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.createView,t),t}return __extends(t,e),t.prototype.createView=function(){this.bg=new eui.Image,this.icon=new eui.Image,this.bg2=new eui.Image,this.textField=new egret.TextField,this.bg.texture=RES.getRes("loading_jpg"),this.icon.texture=RES.getRes("loading2_png"),this.bg2.texture=RES.getRes("toast-bg_png"),this.addChild(this.bg),this.addChild(this.icon),this.addChild(this.bg2),this.addChild(this.textField),this.bg.width=this.stage.stageWidth,this.bg.height=this.stage.stageHeight,this.icon.anchorOffsetX=this.icon.width/2,this.icon.anchorOffsetY=this.icon.height/2,this.icon.x=this.stage.stageWidth/2,this.icon.y=this.stage.stageHeight/2,this.textField.anchorOffsetY=this.textField.height/2,this.textField.anchorOffsetX=this.textField.width/2,this.textField.x=0,this.textField.y=this.stage.stageHeight/2,this.textField.width=this.stage.stageWidth,this.textField.height=20,this.textField.size=20,this.textField.textAlign="center",this.tw=egret.Tween.get(this.icon,{loop:!0}),this.tw.to({rotation:360},500)},t.prototype.onProgress=function(e,t){this.textField.text=Math.floor(e/t*100)+"%"},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),platform.showShareMenu(),platform.getUserInfo().then(function(e){console.log("成功",e)})["catch"](function(e){console.log("失败",e)}),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),egret.ImageLoader.crossOrigin="anonymous",[4,RES.loadConfig("default.res.json","http://localhost:8888/resource/")];case 1:return n.sent(),[4,RES.loadGroup("loading")];case 2:return n.sent(),e=new LoadingUI,this.stage.addChild(e),[4,this.loadTheme()];case 3:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 4:return n.sent(),this.stage.removeChild(e),[3,6];case 5:return t=n.sent(),console.error(t),[3,6];case 6:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var r=new eui.Theme("resource/default.thm.json",e.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){this.addChild(SceneManager.getInstance().gameScene),SceneManager.getInstance().setRootScene(SceneManager.getInstance().gameScene.sceneGroup)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.shareAppMessage=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.showShareMenu=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var PlayerScene=function(e){function t(){var t=e.call(this)||this;return t.skinName="PlayerSceneSkin",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),console.log(this.equip),console.log(this.strength);var t=[{img:"skillIcon01_png",name:"旋龙斩杀"},{img:"skillIcon02_png",name:"魔魂天咒"},{img:"skillIcon03_png",name:"天魔舞"},{img:"skillIcon04_png",name:"痴情咒"},{img:"skillIcon05_png",name:"无间寂"},{img:"skillIcon06_png",name:"霸天撸杀"},{img:"skillIcon07_png",name:"旋龙斩杀"}],n=new eui.ArrayCollection(t);this.equippedList.dataProvider=n,this.equippedList.itemRenderer=EquippedItem,this.equip.changeImg("btnEquip_png"),this.strength.changeImg("btnStrengthen_png"),this.equip.anchorOffsetX=this.equip.width/2,this.equip.anchorOffsetY=this.equip.height/2,this.strength.anchorOffsetX=this.strength.width/2,this.strength.anchorOffsetY=this.strength.height/2,this.equippedScroller.horizontalScrollBar.autoVisibility=!1,this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickFunc,this)},t.prototype.clickFunc=function(){SceneManager.getInstance().removeScene(SceneManager.getInstance().playerScene),SceneManager.getInstance().gameScene.myIconGroup.playerIcon.currentState="up"},t}(eui.Component);__reflect(PlayerScene.prototype,"PlayerScene");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function o(e){t.call(r,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(r))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var c=e.split("/");c.pop();var s=c.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(s,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(r,generateJSON.paths[e])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var SceneManager=function(){function e(){this.gameScene=new GameScene,this.playerScene=new PlayerScene,this.heroScene=new HeroScene,this.goodsScene=new GoodsScene,this.aboutScene=new AboutScene}return e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.setRootScene=function(e){this.rootScene=e},e.prototype.addScene=function(e,t){t?t.addChild(e):this.rootScene.addChild(e),e.x=-e.width;var n=egret.Tween.get(e);n.to({x:(this.gameScene.width-e.width)/2},300)},e.prototype.removeScene=function(e,t){t?t.removeChild(e):this.rootScene.removeChild(e)},e.prototype.removeAllScene=function(e){e?e.removeChildren():this.rootScene.removeChildren()},e}();__reflect(SceneManager.prototype,"SceneManager");